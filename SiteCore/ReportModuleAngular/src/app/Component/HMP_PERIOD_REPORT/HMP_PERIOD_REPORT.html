<h2>
    Список ВМП за период
</h2>

<label>с </label>  <p-calendar [(ngModel)]="dateB" view="month" dateFormat="MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
<label> по </label> <p-calendar [(ngModel)]="dateE" view="month" dateFormat="MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
<input type="button" value="Запрос" class="ActionButton" (click)="getReport()" [disabled]="isLoad" style="margin-left: 10px;" />
<hr />
<div style="overflow: auto">
    <p-table [value]="report" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true" styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
        <ng-template pTemplate="colgroup">
            <colgroup>
                <col style="width:130px">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 400px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 400px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 300px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">

            </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th pResizableColumn>SLUCH_ID</th>
                <th pResizableColumn>СМО</th>
                <th pResizableColumn>Код МО</th>
                <th pResizableColumn>Наименование МО</th>
                <th pResizableColumn>Год</th>
                <th pResizableColumn>Месяц</th>
                <th pResizableColumn>ФИО</th>
                <th pResizableColumn>Пол(1-мужской, 2 женский)</th>
                <th pResizableColumn>Тип ДПФС</th>
                <th pResizableColumn>Серия ДПФС</th>
                <th pResizableColumn>№ ДПФС</th>
                <th pResizableColumn>Возраст</th>
                <th pResizableColumn>Вид ВМП</th>
                <th pResizableColumn>Метод ВМП</th>
                <th pResizableColumn>Группа ВМП</th>
                <th pResizableColumn>Длительность</th>
                <th pResizableColumn>Диагноз</th>
                <th pResizableColumn>Сумма принятая</th>

            </tr>
        </ng-template>
        <ng-template pTemplate="body" let-item>
            <tr>
                <td>{{item.SLUCH_ID}}</td>
                <td>{{item.SMO}}</td>
                <td>{{item.CODE_MO}}</td>
                <td>{{item.NAME_MO}}</td>
                <td>{{item.YEAR}}</td>
                <td>{{item.MONTH}}</td>
                <td>{{item.FIO}}</td>
                <td>{{item.W}}</td>
                <td>{{item.VPOLIS}}</td>
                <td>{{item.SPOLIS}}</td>
                <td>{{item.NPOLIS}}</td>
                <td>{{item.AGE}}</td>
                <td>{{item.VID_HMP}}</td>
                <td>{{item.METOD_HMP}}</td>
                <td>{{item.GRP_HMP}}</td>
                <td>{{item.DAYS}}</td>
                <td>{{item.MKB}}</td>
                <td style="text-align:right">{{item.SUMP| number:'.2':'ru-RU'}}</td>
            </tr>
        </ng-template>
    </p-table>
</div>
<hr />
<button class="ActionButton" (click)="getXls()" [disabled]="isLoad || report.length===0">Скачать Excel</button>
