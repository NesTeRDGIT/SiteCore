<h2>Перечень показателей результативности деятельности медицинских организаций и критерии их оценки</h2>

<label>с </label>  <p-calendar [(ngModel)]="dateB" dateFormat="d MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
<label> по </label> <p-calendar [(ngModel)]="dateE" dateFormat="d MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
<input type="button" value="Запрос" class="ActionButton" (click)="getReport()" [disabled]="isLoad" style="margin-left: 10px;" />
<hr />
<div style="overflow: auto">
    <p-table [value]="report" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true" styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
        <ng-template pTemplate="colgroup">
            <colgroup>
                <col style="width: 300px">
                <col style="width: 110px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
            </colgroup>

        </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th rowspan="6" pResizableColumn>Наименование медицинской организации</th>
                        <th colspan="4" pResizableColumn>Доля обоснованных жалоб пациентов на работу медицинской организации</th>
                        <th colspan="4" pResizableColumn>Доля<br> нарушений, выявленных при проведении медико-экономической<br> экспертизы<br> </th>
                        <th colspan="4" pResizableColumn>Доля<br> нарушений, выявленных при проведении экспертизы качества<br> медицинской помощи<br> <br> </th>
                        <th rowspan="6" pResizableColumn>Общий балл</th>
                    </tr>
                    <tr>
                        <th rowspan="5" pResizableColumn>Количество жалоб всего</th>
                        <th rowspan="5" pResizableColumn>из них обоснованные </th>
                        <th rowspan="5" pResizableColumn>Доля обоснованных %</th>
                        <th rowspan="2" pResizableColumn>Нормативный балл</th>
                        <th rowspan="5" pResizableColumn>Количество МЭЭ всего</th>
                        <th rowspan="5" pResizableColumn>из них с<br> нарушениями </th>
                        <th rowspan="5" pResizableColumn>Доля нарушений %</th>
                        <th rowspan="2" pResizableColumn>Нормативный балл </th>
                        <th rowspan="5" pResizableColumn>Количество ЭКМП всего</th>
                        <th rowspan="5" pResizableColumn>из них с<br> нарушениями </th>
                        <th rowspan="5" pResizableColumn>Доля нарушений %</th>
                        <th rowspan="2" pResizableColumn>Нормативный балл </th>
                    </tr>
                    <tr></tr>
                    <tr>
                        <th pResizableColumn>&lt; 5% - 15</th>
                        <th pResizableColumn>&lt; 20% - 8</th>
                        <th pResizableColumn>&lt; 20% - 8</th>
                    </tr>
                    <tr>
                        <th pResizableColumn>5-10% - 11</th>
                        <th pResizableColumn>20-50% - 6</th>
                        <th pResizableColumn>20-50% - 6</th>
                    </tr>
                    <tr>
                        <th pResizableColumn>&gt; 10% - 7</th>
                        <th pResizableColumn>&gt; 50% - 3</th>
                        <th pResizableColumn>&gt; 50% - 3</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>{{item.NAM_MOK}}</td>
                        <td>{{item.COUNT}}</td>
                        <td>{{item.COUNT_OSN}}</td>
                        <td>{{item.DOL_OSN}}</td>
                        <td>{{item.BAL_OSN}}</td>
                        <td>{{item.C_MEE}}</td>
                        <td>{{item.C_MEE_ERR}}</td>
                        <td>{{item.DOL_MEE}}</td>
                        <td>{{item.BAL_MEE}}</td>
                        <td>{{item.C_EKMP}}</td>
                        <td>{{item.C_EKMP_ERR}}</td>
                        <td>{{item.DOL_EKMP}}</td>
                        <td>{{item.BAL_EKMP}}</td>
                        <td>{{item.SUM_BAL}}</td>
                    </tr>
                </ng-template>
</p-table>
</div>
<hr />
<button class="ActionButton" (click)="getXls()" [disabled]="isLoad || report.length===0">Скачать Excel</button>
