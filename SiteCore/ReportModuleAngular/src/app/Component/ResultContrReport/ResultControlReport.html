<h2>
    Результаты контрольно-экспертных мероприятий, проведенных в отношении медицинских организаций, направивших застрахованных лиц на медико-социальную экспертизу
</h2>
<label>с </label>  <p-calendar [(ngModel)]="dateB" view="month" dateFormat="MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
    <label> по </label> <p-calendar [(ngModel)]="dateE" view="month" dateFormat="MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true" [disabled]="isLoad"></p-calendar>
    <input type="button" value="Запрос" class="ActionButton" (click)="getReport()" [disabled]="isLoad" style="margin-left: 10px;" />
<hr />

<p-tabView>
    <p-tabPanel header="Взрослые">
        <div style="overflow: auto">
            <p-table [value]="reportVZR" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true" styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
                <ng-template pTemplate="colgroup">
                    <colgroup>
                        <col style="width: 80px">
                        <col style="width: 300px ">
                        <col style="width: 100px ">
                        <col style="width: 140px ">
                        <col style="width: 140px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 300px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">

                    </colgroup>

                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th rowspan="3">№ п.п.</th>
                        <th rowspan="3">Диагноз</th>
                        <th rowspan="3">Код по МКБ-10</th>
                        <th colspan="39">Застрахованные лица 18 лет и старше</th>
                    </tr>
                    <tr>
                        <th rowspan="2">Количество застрахованных лиц, направленных на МСЭ, всего</th>
                        <th rowspan="2">Количество застрахованных лиц, в отношении которых проведена МСЭ, всего</th>
                        <th colspan="4">их них количество застрахованных лиц, у которых впервые установлена группа инвалидности</th>
                        <th rowspan="2">Количество застрахованных лиц, получивших отказа в освидетельствовании по причине неполного обследования</th>
                        <th colspan="2">Количество нарушений(дефектов), выявленных при проведении контрольно-экспертных мероприятий(в соответствии с Перечнем оснований для отказа в оплате мед. помощи), из них</th>
                        <th colspan="2">Размер примененных финансовых санкций(руб.)</th>
                        <th colspan="28">Количество выявленных нарушений(в соответствии с Перечнем оснований для отказа в оплате мед. помощи) по коду:</th>
                    </tr>
                    <tr>
                        <th>Всего, их них:</th>
                        <th>1 группа</th>
                        <th>2 группа</th>
                        <th>3 группа</th>
                        <th>выявленные ТФОМС</th>
                        <th>выявленные СМО</th>
                        <th>неоплата (уменьшение оплаты)</th>
                        <th>штраф</th>
                        <th>Всего</th>
                        <th>2.1.</th>
                        <th>2.3.</th>
                        <th>2.3.2.</th>
                        <th>2.7.</th>
                        <th>2.9.</th>
                        <th>2.12.</th>
                        <th>2.14.</th>
                        <th>2.15.</th>
                        <th>2.16.1.</th>
                        <th>2.16.2</th>
                        <th>2.17.</th>
                        <th>3.1.</th>
                        <th>3.1.2.</th>
                        <th>3.1.3.</th>
                        <th>3.1.4.</th>
                        <th>3.1.5.</th>
                        <th>3.2.</th>
                        <th>3.2.1.</th>
                        <th>3.2.2.</th>
                        <th>3.2.3.</th>
                        <th>3.2.4.</th>
                        <th>3.3.</th>
                        <th>3.4.</th>
                        <th>3.5.</th>
                        <th>3.6.</th>
                        <th>3.9.</th>
                        <th>3.11.</th>
                    </tr>
                    <tr>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4 &#8805; 5 + 7</th>
                        <th>5</th>
                        <th>6</th>
                        <th>7</th>
                        <th>8</th>
                        <th>9</th>
                        <th>10</th>
                        <th>11</th>
                        <th>12</th>
                        <th>13</th>
                        <th>14</th>
                        <th>15</th>
                        <th>16</th>
                        <th>17</th>
                        <th>18</th>
                        <th>19</th>
                        <th>20</th>
                        <th>21</th>
                        <th>22</th>
                        <th>23</th>
                        <th>24</th>
                        <th>25</th>
                        <th>26</th>
                        <th>27</th>
                        <th>28</th>
                        <th>29</th>
                        <th>30</th>
                        <th>31</th>
                        <th>32</th>
                        <th>33</th>
                        <th>34</th>
                        <th>35</th>
                        <th>36</th>
                        <th>37</th>
                        <th>38</th>
                        <th>39</th>
                        <th>40</th>
                        <th>41</th>
                        <th>42</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>{{item.NN}}</td>
                        <td>{{item.DIAG}}</td>
                        <td>{{item.MKB}}</td>
                        <td>{{item.ST4| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST5| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST6| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST7| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST8| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST9| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST10| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST11| number:'.2':'ru-RU'}}</td>
                        <td>{{item.ST12| number:'.2':'ru-RU'}}</td>
                        <td>{{item.ST13| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST14| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST15| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST16| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST17| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST18| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST19| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST20| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST21| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST22| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST23| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST24| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST25| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST26| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST27| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST28| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST29| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST30| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST31| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST32| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST33| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST34| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST35| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST36| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST37| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST38| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST39| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST40| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST41| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST42| number:'.0':'ru-RU'}}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </p-tabPanel>
    <p-tabPanel header="Дети">
        <div style="overflow: auto">
            <p-table [value]="reportDET" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true" styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
                <ng-template pTemplate="colgroup">
                    <colgroup>
                        <col style="width: 80px">
                        <col style="width: 300px ">
                        <col style="width: 100px ">
                        <col style="width: 140px ">
                        <col style="width: 140px ">
                        <col style="width: 130px ">
                        <col style="width: 300px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">
                        <col style="width: 130px ">

                    </colgroup>

                </ng-template>
                <ng-template pTemplate="header">
                    <tr>
                        <th rowspan="3">№ п.п.</th>
                        <th rowspan="3">Диагноз</th>
                        <th rowspan="3">Код по МКБ-10</th>
                        <th colspan="36">Несовершенолетние(от 0 до 18) застрахованные лица</th>
                    </tr>
                    <tr>
                        <th rowspan="2">Количество застрахованных лиц, направленных на МСЭ, всего</th>
                        <th rowspan="2">Количество застрахованных лиц, в отношении которых проведена МСЭ, всего</th>
                        <th rowspan="2">их них количество застрахованных лиц, у которых впервые установлена категория "ребёнок-инвалид"</th>
                        <th rowspan="2">Количество застрахованных лиц, получивших отказа в освидетельствовании по причине неполного обследования</th>
                        <th colspan="2">Количество нарушений(дефектов), выявленных при проведении контрольно-экспертных мероприятий(в соответствии с Перечнем оснований для отказа в оплате мед. помощи), из них</th>
                        <th colspan="2">Размер примененных финансовых санкций(руб.)</th>
                        <th colspan="28">Количество выявленных нарушений(в соответствии с Перечнем оснований для отказа в оплате мед. помощи) по коду:</th>
                    </tr>
                    <tr>
                        <th>выявленные ТФОМС</th>
                        <th>выявленные СМО</th>
                        <th>неоплата (уменьшение оплаты)</th>
                        <th>штраф</th>
                        <th>Всего</th>
                        <th>2.1.</th>
                        <th>2.3.</th>
                        <th>2.3.2.</th>
                        <th>2.7.</th>
                        <th>2.9.</th>
                        <th>2.12.</th>
                        <th>2.14.</th>
                        <th>2.15.</th>
                        <th>2.16.1.</th>
                        <th>2.16.2</th>
                        <th>2.17.</th>
                        <th>3.1.</th>
                        <th>3.1.2.</th>
                        <th>3.1.3.</th>
                        <th>3.1.4.</th>
                        <th>3.1.5.</th>
                        <th>3.2.</th>
                        <th>3.2.1.</th>
                        <th>3.2.2.</th>
                        <th>3.2.3.</th>
                        <th>3.2.4.</th>
                        <th>3.3.</th>
                        <th>3.4.</th>
                        <th>3.5.</th>
                        <th>3.6.</th>
                        <th>3.9.</th>
                        <th>3.11.</th>
                    </tr>
                    <tr>
                        <th>1</th>
                        <th>2</th>
                        <th>3</th>
                        <th>4 &#8805; 5 + 7</th>
                        <th>5</th>
                        <th>6</th>
                        <th>7</th>
                        <th>8</th>
                        <th>9</th>
                        <th>10</th>
                        <th>11</th>
                        <th>12</th>
                        <th>13</th>
                        <th>14</th>
                        <th>15</th>
                        <th>16</th>
                        <th>17</th>
                        <th>18</th>
                        <th>19</th>
                        <th>20</th>
                        <th>21</th>
                        <th>22</th>
                        <th>23</th>
                        <th>24</th>
                        <th>25</th>
                        <th>26</th>
                        <th>27</th>
                        <th>28</th>
                        <th>29</th>
                        <th>30</th>
                        <th>31</th>
                        <th>32</th>
                        <th>33</th>
                        <th>34</th>
                        <th>35</th>
                        <th>36</th>
                        <th>37</th>
                        <th>38</th>
                        <th>39</th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-item>
                    <tr>
                        <td>{{item.NN}}</td>
                        <td>{{item.DIAG}}</td>
                        <td>{{item.MKB}}</td>
                        <td>{{item.ST4| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST5| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST6| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST7| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST8| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST9| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST10| number:'.2':'ru-RU'}}</td>
                        <td>{{item.ST11| number:'.2':'ru-RU'}}</td>
                        <td>{{item.ST12| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST13| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST14| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST15| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST16| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST17| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST18| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST19| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST20| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST21| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST22| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST23| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST24| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST25| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST26| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST27| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST28| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST29| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST30| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST31| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST32| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST33| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST34| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST35| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST36| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST37| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST38| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST39| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST40| number:'.0':'ru-RU'}}</td>
                        <td>{{item.ST41| number:'.0':'ru-RU'}}</td>
                    </tr>
                </ng-template>
            </p-table>
        </div>
    </p-tabPanel>
</p-tabView>
    <hr />
    <button class="ActionButton" (click)="getXls()" [disabled]="isLoad || (reportVZR.length===0 && reportDET.length===0)">Скачать Excel</button>
