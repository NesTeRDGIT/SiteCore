<h2>Кохлеарная имплантация за отчетный период</h2>
<h5>Выборка по дате оплаты</h5>

<label>с </label>
<p-calendar [(ngModel)]="dateB" dateFormat="d MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true"
    [disabled]="isLoad"></p-calendar>
<label> по </label>
<p-calendar [(ngModel)]="dateE" dateFormat="d MM yy" [yearNavigator]="true" yearRange="2000:2030" [readonlyInput]="true"
    [disabled]="isLoad"></p-calendar>

<input type="button" value="Запрос" class="ActionButton" (click)="getReport()" [disabled]="isLoad"
    style="margin-left: 10px;" />
<hr />
<div style="overflow: auto">
    <p-table [value]="report" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true"
        styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
        <ng-template pTemplate="colgroup">
            <colgroup>
                <col style="width: 100px">
                <col style="width: 100px ">
                <col style="width: 100px ">
                <col style="width: 200px ">
                <col style="width: 100px ">
                <col style="width: 100px ">
                <col style="width: 250px ">
                <col style="width: 100px ">
                <col style="width: 250px ">
                <col style="width: 150px ">
                <col style="width: 150px ">
                <col style="width: 150px ">
                <col style="width: 150px ">
            </colgroup>
        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th rowspan="2" style="text-align:center" pResizableColumn>Год</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Месяц</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Код МО</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Наименование МО</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Условия оказания</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>КСГ</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Наименование</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Профиль</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Наименование</th>
                <th colspan="2" style="text-align:center" pResizableColumn>Предъявлено</th>
                <th colspan="2" style="text-align:center" pResizableColumn>Принято</th>
            </tr>
            <tr>
                <th rowspan="2" style="text-align:center" pResizableColumn>Кол-во</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Сумма</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Кол-во</th>
                <th rowspan="2" style="text-align:center" pResizableColumn>Сумма</th>
            </tr>


        </ng-template>
        <ng-template pTemplate="body" let-item>
            <tr>
                <td style="text-align:center">{{item.Year}}</td>
                <td style="text-align:center">{{item.Month}}</td>
                <td style="text-align:center">{{item.Code_MO}}</td>
                <td style="text-align:center">{{item.Nam_MOK}}</td>
                <td style="text-align:center">{{item.Usl_OK}}</td>
                <td style="text-align:center">{{item.N_KSG}}</td>
                <td style="text-align:center">{{item.Name_KSG}}</td>
                <td style="text-align:center">{{item.Id_Profil}}</td>
                <td style="text-align:center">{{item.Name}}</td>
                <td style="text-align:center">{{item.C}}</td>
                <td style="text-align:center">{{item.S}}</td>
                <td style="text-align:center">{{item.C_P}}</td>
                <td style="text-align:center">{{item.S_P}}</td>


            </tr>
        </ng-template>
    </p-table>

</div>

<hr />
<button class="ActionButton" (click)="getXls()" [disabled]="isLoad|| report.length===0">Скачать Excel</button>