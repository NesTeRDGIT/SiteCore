<h2>Диспансеризация и профилактические осмотры застрахованных лиц старше 55 лет</h2>
<h4>Принятые к оплате, нарастающим итогом</h4>
<label>Отчетный год: </label>
<input type="number" value="{{year}}" required [disabled]="isLoad" />
<input type="button" value="Запрос" class="ActionButton" (click)="getReport()" [disabled]="isLoad" style="margin-left: 10px;" />
<hr />
<div style="overflow: auto">
    <p-table [value]="report" [scrollable]="true" scrollHeight="70vh" [resizableColumns]="true" [autoLayout]="true" styleClass="p-datatable-gridlines" columnResizeMode="expand" [loading]="isLoad">
        <ng-template pTemplate="colgroup">
            <colgroup>
                <col style="width: 130px">
                <col style="width: 300px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
                <col style="width: 130px ">
            </colgroup>

        </ng-template>
        <ng-template pTemplate="header">
            <tr>
                <th rowspan="3" pResizableColumn>Код МО</th>
                <th rowspan="3" pResizableColumn>Наименование МО</th>
                <th colspan="4" pResizableColumn>55+ женщины, 60+ мужчины</th>
                <th colspan="4" pResizableColumn>в том числе 65+</th>
            </tr>
            <tr>
                <th colspan="2" pResizableColumn>Диспансеризация</th>
                <th colspan="2" pResizableColumn>Проф.осмотры</th>
                <th colspan="2" pResizableColumn>Диспансеризация</th>
                <th colspan="2" pResizableColumn>Проф.осмотры</th>
            </tr>
            <tr>
                <th pResizableColumn>муж.</th>
                <th pResizableColumn>жен.</th>
                <th pResizableColumn>муж.</th>
                <th pResizableColumn>жен.</th>
                <th pResizableColumn>муж.</th>
                <th pResizableColumn>жен.</th>
                <th pResizableColumn>муж.</th>
                <th pResizableColumn>жен.</th>
            </tr>

        </ng-template>

        <ng-template pTemplate="body" let-item>
            <tr>
                <td>{{item.CODE_MO}}</td>
                <td>{{item.NAME}}</td>
                <td>{{item.DISP_M_GR1| number:'.0':'ru-RU'}}</td>
                <td>{{item.DISP_G_GR1| number:'.0':'ru-RU'}}</td>
                <td>{{item.PROF_M_GR1| number:'.0':'ru-RU'}}</td>
                <td>{{item.PROF_G_GR1| number:'.0':'ru-RU'}}</td>
                <td>{{item.DISP_M_GR2| number:'.0':'ru-RU'}}</td>
                <td>{{item.DISP_G_GR2| number:'.0':'ru-RU'}}</td>
                <td>{{item.PROF_M_GR2| number:'.0':'ru-RU'}}</td>
                <td>{{item.PROF_G_GR2| number:'.0':'ru-RU'}}</td>

            </tr>
        </ng-template>
    </p-table>
</div>
<hr />
<button class="ActionButton" (click)="getXls()" [disabled]="isLoad || report.length===0">Скачать Excel</button>
